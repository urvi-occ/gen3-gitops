access-backend:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/access-backend
    tag: '2025.11'
  externalSecrets:
    accessBackendG3auto: bdcatprod-access-backend-g3auto
    accessBackendKv: bdcatprod-access-backend-kv
    dbcreds: bdcatprod-access-backend-dbcreds
  serviceAccount:
    annotations:
      eks.amazonaws.com/role-arn: arn:aws:iam::895962626746:role/bdcatprod--bdcatprod-helm--access-backend-sa
arborist:
  autoscaling:
    enabled: false
    maxReplicas: 4
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/arborist
    tag: '2025.11'
audit:
  enabled: true
  externalSecrets:
    auditG3auto: bdcatprod-audit-g3auto
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/audit-service
    tag: '2025.11'
  serviceAccount:
    annotations:
      eks.amazonaws.com/role-arn: arn:aws:iam::895962626746:role/bdcatprod--bdcatprod-helm--audit-sqs-receiver
aws-es-proxy:
  enabled: true
  esEndpoint: vpc-bdcatprod-gen3-metadata-2-pcd35dshhorfobahqwfnugnovq.us-east-1.es.amazonaws.com
  image:
    repository: quay.io/cdis/aws-es-proxy
    tag: v1.3.1
awshelper:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/awshelper
    tag: '2025.11'
etl:
  resources:
    tube:
      requests:
        memory: 4Gi
    spark:
      requests:
        memory: 2Gi
  esGarbageCollect:
    enabled: true
  esEndpoint: elasticsearch
  etlMapping:
    mappings:
      - aggregated_props:
          - fn: set
            name: annotated_sex
            path: demographics
            src: annotated_sex
          - fn: set
            name: race
            path: demographics
            src: race
          - fn: set
            name: ethnicity
            path: demographics
            src: ethnicity
          - fn: count
            name: _samples_count
            path: samples
          - fn: count
            name: _aliquots_count
            path: samples.aliquots
          - fn: count
            name: _read_groups_count
            path: samples.aliquots.read_groups
          - fn: count
            name: _submitted_unaligned_reads_files_count
            path: samples.aliquots.read_groups.submitted_unaligned_reads_files
          - fn: count
            name: _submitted_aligned_reads_files_count
            path: samples.aliquots.read_groups.submitted_aligned_reads_files
          - fn: count
            name: _simple_germline_variations_count
            path: samples.aliquots.read_groups.simple_germline_variations
          - fn: set
            name: current_smoker_baseline
            path: exposures
            src: current_smoker_baseline
          - fn: set
            name: ever_smoker_baseline
            path: exposures
            src: ever_smoker_baseline
        doc_type: subject
        flatten_props:
          - path: demographics
            props:
              - name: age_at_index
              - name: hispanic_subgroup
              - name: subcohort
              - name: weight_baseline
              - name: bmi_baseline
              - name: height_baseline
          - path: medical_histories
            props:
              - name: diabetes
              - name: hypertension
              - name: cerebrovascular_disease
              - name: chronic_respiratory_disease
              - name: coronary_artery_disease
              - name: asthma
              - name: cabg_presence
              - name: copd
              - name: emphysema
              - name: heart_failure
              - name: myocardial_infarction
              - name: stroke
              - name: cac_score
              - name: cac_volume
              - name: carotid_plaque
              - name: carotid_stenosis
              - name: cimt_1
              - name: cimt_2
              - name: vte_case_status
              - name: vte_followup_start_age
              - name: vte_prior_history
          - path: medication_records
            props:
              - name: hypertension_meds
              - name: antihypertensive_meds
              - name: fasting_lipids
              - name: lipid_lowering_medication
          - path: lab_results
            props:
              - name: lymphocyte_ncnc_bld
              - name: mch_entmass_rbc
              - name: mcv_entvol_rbc
              - name: mchc_mcnc_rbc
              - name: monocyte_ncnc_bld
              - name: neutrophil_ncnc_bld
              - name: pmv_entvol_bld
              - name: rbc_ncnc_bld
              - name: rdw_ratio_rbc
              - name: hemoglobin_mcnc_bld
              - name: platelet_ncnc_bld
              - name: hematocrit_vfr_bld
              - name: wbc_ncnc_bld
              - name: basophil_ncnc_bld
              - name: eosinophil_ncnc_bld
              - name: unit_triglycerides
              - name: hdl
              - name: ldl
              - name: triglycerides
              - name: total_cholesterol
        joining_props:
          - index: file
            join_on: _subject_id
            props:
              - fn: set
                name: data_format
                src: data_format
              - fn: set
                name: data_type
                src: data_type
              - fn: count
                name: file_count
                src: _file_id
        name: gen3.biodatacatalyst.nhlbi.nih.gov_subject
        parent_props:
          - path: studies[studies_submitter_id:submitter_id].projects[code]
          - path: studies[studies_submitter_id:submitter_id].projects[code].programs[programs_name:name]
        props:
          - name: submitter_id
          - name: project_id
          - name: consent_codes
          - name: geographic_site
        root: subject
        type: aggregator
      - category: data_file
        doc_type: file
        injecting_props:
          program:
            props:
              - fn: set
                name: programs_name
                src: name
          project:
            props:
              - fn: set
                name: dbgap_accession_number
                src: dbgap_accession_number
          subject:
            props:
              - fn: set
                name: _subject_id
                src: id
              - name: project_id
        name: gen3.biodatacatalyst.nhlbi.nih.gov_file
        props:
          - name: object_id
          - name: md5sum
          - name: file_name
          - name: file_size
          - name: data_category
          - name: data_format
          - name: data_type
          - name: state
          - name: callset
          - name: bucket_path
          - name: source_node
        root: None
        type: collector
      - category: index_file
        doc_type: index_file
        injecting_props:
          program:
            props:
              - fn: set
                name: programs_name
                src: name
          project:
            props:
              - fn: set
                name: dbgap_accession_number
                src: dbgap_accession_number
          subject:
            props:
              - fn: set
                name: _subject_id
                src: id
              - name: project_id
        name: gen3.biodatacatalyst.nhlbi.nih.gov_index_file
        props:
          - name: object_id
          - name: md5sum
          - name: file_name
          - name: file_size
          - name: data_category
          - name: data_format
          - name: data_type
          - name: state
          - name: callset
          - name: bucket_path
          - name: source_node
        root: None
        type: collector
  image:
    tube:
      tag: '2025.11'
    spark:
      tag: '2025.11'
fence:
  resources:
    requests:
      memory: 500Mi
  usersync:
    usersync: true
    syncFromDbgap: true
    userYamlS3Path: s3://cdis-gen3-users/stageprod/user.yaml
    sshKnownHosts: |
      sftp-private.ncbi.nlm.nih.gov ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCjEuJc/1pAQxGxwuk8s/1u7tDq2PiOqutAXNjPOl0BkOiJJnUa6gdRx5WcVd6HApPrw7RUvUXraOmc82Zlzeno6DkzTjLk3ztuRs1hNF3KKx044AxDC1Jew6pK96At3kAvStfamNbY8URB9tj0SF3rFQxLrWo8WfhFr9AU4SuY5S0A2a/njucmTim3vDRPbBFO7Dlz2dxzeKPBdUDB/NvmdPWHxkviXkqUby/QzjglAQTts5lNEMH8qaRcU/dnWYRKvY17RHGu9/gNf8Z9DvBg8TbU7Ek3MT5A9F3nw1ZcZe7M8L7JwIKgQUl1gzOBHFfC248YES9REQffLYPWOCy9
      sftp-private.ncbi.nlm.nih.gov ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBAFM24A4pG3U+8HzCvEkm9SiEWHOAtQr/DFZd3bf7VYDCcg2FPpUvGRsiDSuzhzBo+eG00d6/6y8NCypWwjiMi1rYgBOh9YA0w/ruutXYMUUVzw361lTgjOBOZ/dt3gKkNgShwDd0e1hnjYk/E7jYc2YJv67ZFy9GzXCWR55LhS/7fGQ5w==
  googleCronJobs:
    enabled: true
  serviceAccount:
    annotations:
      eks.amazonaws.com/role-arn: arn:aws:iam::895962626746:role/bdcatprod--bdcatprod-helm--audit-sqs-sender
  autoscaling:
    enabled: false
    maxReplicas: 15
    minReplicas: 5
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  externalSecrets:
    createSlackWebhookSecret: true
    slackWebhookSecretName: bdcatprod-slack-webhook
    createK8sGoogleAppSecrets: false
    fenceConfig: bdcatprod-fence-config
    fenceGoogleAppCredsSecret: bdcatprod-fence-google-app-creds
    fenceGoogleStorageCredsSecret: bdcatprod-fence-google-storage-creds
    fenceJwtKeys: bdcatprod-fence-jwt
    fenceSshKeys: bdcatprod-fence-ssh-keys
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/fence
    tag: '2025.11'
  FENCE_CONFIG:
    ENABLE_VISA_UPDATE_CRON: true
  FENCE_CONFIG_PUBLIC:
    PRIVACY_POLICY_URL: https://biodatacatalyst.nhlbi.nih.gov/privacy/
    ARBORIST_TIMEOUT: 60
    S3_BUCKETS:
      bdcatpreprod-data-bucket:
        cred: bdcatprod_fence-bot
        region: us-east-1
      bdcatprod-data-bucket:
        cred: bdcatprod_fence-bot
        region: us-east-1
      biolincc-training-datasets-open-access:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      cgp-commons-public:
        cred: '*'
        region: us-east-1
      dcp-ds-bagit-databucket-gen3:
        cred: fence-bot
        region: us-east-1
      gen3-copdgene-imaging:
        cred: fence-bot
        region: us-east-1
      nih-nhgri-datacommons:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_access_gtex
        region: us-east-1
      nih-nhlbi-biodata-catalyst-1000-genomes-high-coverage:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-tutorial-genome-data:
        cred: fence-bot
        region: us-east-1
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
      nih-nhlbi-biodata-catalyst-biolincc-phs002385-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-biolincc-phs002386-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-biolincc-phs002362-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-biolincc-phs002348-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-biolincc-phs002383-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-biodata-catalyst-biolincc-phs2415-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-covid19-phs002363-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-covid19-phs002299-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-datacommons:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_topmed
        region: us-east-1
      nih-nhlbi-topmed-released-phs001600-c1:
        cred: fence-bot
        region: us-east-1
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
      nih-nhlbi-topmed-combined-exchange-area:
        cred: fence-bot
        region: us-east-1
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
      nih-nhlbi-topmed-released-phs001624-c1:
        cred: fence-bot
        region: us-east-1
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
      nih-nhlbi-topmed-released-phs001542-c2:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-topmed-released-phs001603-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-topmed-released-phs001661-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-topmed-released-phs000285-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-topmed-released-phs000285-c2:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-topmed-released-phs001601-c1:
        cred: fence-bot
        role-arn: arn:aws:iam::600168050588:role/developer_bucket_access_imaging_copdgene
        region: us-east-1
      nih-nhlbi-.*:
        cred: fence-bot
        region: us-east-1
      topmed_workflow_testing:
        cred: '*'
        region: us-east-1
      topmed-workflow-testing:
        cred: fence-bot
        region: us-east-1
    ENABLE_VISA_UPDATE_CRON: true
fluentd:
  enabled: true
  image:
    repository: fluent/fluentd-kubernetes-daemonset
    tag: v1.15.3-debian-cloudwatch-1.0
frontend-framework:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/bdc-data-commons
    tag: 1.2.0
gen3-user-data-library:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/gen3-user-data-library
    tag: '2025.11'
  externalSecrets:
    dbcreds: bdcatprod-gen3userdatalibrary-creds
    gen3UserDataLibraryG3auto: bdcatprod-gen3userdatalibrary-g3auto
global:
  pdb: true
  aws:
    account: '895962626746'
    awsEsProxyRole: bdcatprod--bdcatprod-helm--es-access
    enabled: true
    hatchery_role: bdcatprod--bdcatprod-helm--hatchery-sa
    secretStoreServiceAccount:
      enabled: true
      roleArn: arn:aws:iam::895962626746:role/bdcatprod-external-secrets-sa
    wafv2:
      enabled: true
      wafAclArn: arn:aws:wafv2:us-east-1:895962626746:regional/webacl/bdcatprod-waf/41bc2f16-1aa1-41b3-bc63-a82875f5f57d
  dev: false
  dictionaryUrl: https://s3.amazonaws.com/dictionary-artifacts/gtexdictionary/4.8.1/schema.json
  dispatcherJobNum: '10'
  environment: bdcatprod
  externalSecrets:
    createSlackWebhookSecret: true
    slackWebhookSecretName: bdcatprod-slack-webhook
    deploy: true
  hostname: gen3.biodatacatalyst.nhlbi.nih.gov
  fenceURL: https://gen3.biodatacatalyst.nhlbi.nih.gov/user
  publicDataSets: true
  manifestGlobalExtraValues:
    kube_bucket: kube-stageprod-gen3
    logs_bucket: logs-stageprod-gen3
  tierAccessLevel: regular
  tierAccessLimit: 50
  portalApp: gitops
  postgres:
    dbCreate: false
  revproxyArn: arn:aws:acm:us-east-1:895962626746:certificate/472403d1-09a8-4d10-a5de-9b316f7da980
guppy:
  authFilterField: auth_resource_path
  autoscaling:
    enabled: false
    maxReplicas: 4
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  configIndex: gen3.biodatacatalyst.nhlbi.nih.gov_array-config
  enabled: true
  esEndpoint: http://elasticsearch:9200
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/guppy
    tag: '2025.11'
  indices:
    - index: gen3.biodatacatalyst.nhlbi.nih.gov_subject
      type: subject
    - index: gen3.biodatacatalyst.nhlbi.nih.gov_file
      type: file
hatchery:
  enabled: false
indexd:
  defaultPrefix: dg.4503/
  autoscaling:
    enabled: false
    maxReplicas: 8
    minReplicas: 4
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  externalSecrets:
    serviceCreds: bdcatprod-indexd-service-creds
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/indexd
    tag: '2025.11'
manifestservice:
  enabled: true
  externalSecrets:
    manifestserviceG3auto: bdcatprod-manifestservice-g3auto
  image:
    tag: '2025.11'
metadata:
  autoscaling:
    enabled: false
    maxReplicas: 5
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  esEndpoint: http://elasticsearch:9200
  externalSecrets:
    metadataG3auto: bdcatprod-metadata-g3auto
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/metadata-service
    tag: '2025.11'
metadata-delete-expired-objects:
  enabled: true
  image:
    repository: quay.io/cdis/metadata-delete-expired-objects
    tag: '2025.07'
peregrine:
  autoscaling:
    enabled: false
    maxReplicas: 4
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/peregrine
    tag: '2025.11'
portal:
  autoscaling:
    enabled: false
    maxReplicas: 4
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  customConfig:
    enabled: true
    dir: bdcatprod/gen3.biodatacatalyst.nhlbi.nih.gov/values/portal/
    repo: https://github.com/uc-cdis/gen3-gitops.git
    branch: master
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/data-portal
    tag: 'feature_data_library'
    pullPolicy: Always
revproxy:
  autoscaling:
    enabled: false
    maxReplicas: 10
    minReplicas: 4
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/nginx
    tag: '2025.11'
  ingress:
    aws:
      group: bdcatprod
      sslPolicy: ELBSecurityPolicy-TLS13-1-2-FIPS-2023-04
sheepdog:
  autoscaling:
    enabled: false
    maxReplicas: 4
    minReplicas: 2
    targetCPUUtilizationPercentage: 90
  replicaCount: 4
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/sheepdog
    tag: '2025.11'
sower:
  enabled: true
  externalSecrets:
    createK8sPelicanServiceSecret: false
    pelicanserviceG3auto: bdcatprod-pelicanservice-g3auto
    createK8sSowerJobsSecret: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/sower
    tag: '2025.11'
  sowerConfig:
    - action: export
      container:
        cpu-limit: '1'
        env:
          - name: DICTIONARY_URL
            valueFrom:
              configMapKeyRef:
                key: dictionary_url
                name: manifest-global
          - name: DB_HOST
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: host
          - name: DB_DATABASE
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: database
          - name: DB_USER
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: username
          - name: DB_PASS
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: password
          - name: GEN3_HOSTNAME
            valueFrom:
              configMapKeyRef:
                key: hostname
                name: manifest-global
          - name: ROOT_NODE
            value: subject
        image: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/pelican-export:2025.11
        memory-limit: 12Gi
        name: job-task
        pull_policy: Always
        volumeMounts:
          - mountPath: /pelican-creds.json
            name: pelican-creds-volume
            readOnly: true
            subPath: config.json
      name: pelican-export
      restart_policy: Never
      volumes:
        - name: pelican-creds-volume
          secret:
            secretName: pelicanservice-g3auto
    - action: export-files
      container:
        cpu-limit: '1'
        env:
          - name: DICTIONARY_URL
            valueFrom:
              configMapKeyRef:
                key: dictionary_url
                name: manifest-global
          - name: GEN3_HOSTNAME
            valueFrom:
              configMapKeyRef:
                key: hostname
                name: manifest-global
          - name: ROOT_NODE
            value: file
          - name: EXTRA_NODES
            value: ''
          - name: DB_HOST
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: host
          - name: DB_DATABASE
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: database
          - name: DB_USER
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: username
          - name: DB_PASS
            valueFrom:
              secretKeyRef:
                name: sheepdog-dbcreds
                key: password
          - name: SHEEPDOG
            valueFrom:
              secretKeyRef:
                name: indexd-service-creds
                key: sheepdog
        image: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/pelican-export:2025.11
        memory-limit: 12Gi
        name: job-task
        pull_policy: Always
        volumeMounts:
          - mountPath: /pelican-creds.json
            name: pelican-creds-volume
            readOnly: true
            subPath: config.json
      name: pelican-export-files
      restart_policy: Never
      volumes:
        - name: pelican-creds-volume
          secret:
            secretName: pelicanservice-g3auto
spark:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/gen3-spark
    tag: '2025.07'
ssjdispatcher:
  externalSecrets:
    credsFile: bdcatprod-ssjdispatcher-creds
  indexing: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/indexs3client:2025.07
tube:
  enabled: true
  image:
    repository: 707767160287.dkr.ecr.us-east-1.amazonaws.com/gen3/tube
    tag: '2025.07'
wts:
  enabled: false
